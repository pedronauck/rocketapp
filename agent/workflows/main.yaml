id: pokemon-discover
version: 0.1.0
description: Discover which pokemon is based on a photo

schemas:
  - id: main_input
    type: object
    properties:
      image:
        type: string
        description: The image of the pokemon to discover
    required:
      - image

config:
  input:
    $ref: local::schemas.#(id=="main_input")

tools:
  - id: image_tool
    description: Discover which pokemon is based on a photo
    input:
      $ref: local::schemas.#(id=="image_input")

agents:
  - id: greeter
    config:
      $ref: global::models.#(provider=="openai")
    instructions: |
      You are a friendly assistant that creates personalized greetings.
      Use the greeting tool to generate an appropriate greeting, then enhance it with a thoughtful message.
    tools:
      - $ref: local::tools.#(id=="greeting_tool")
    actions:
      - id: create_greeting
        prompt: |
          Please create a greeting for {{ .workflow.input.name }} using the {{ .workflow.input.style }} style.
          After generating the greeting, add a brief, personalized message to make it more engaging.

tasks:
  - id: greet
    type: basic
    $use: agent(local::agents.#(id=="greeter"))
    action: create_greeting
    final: true

outputs:
  greeting: "{{ .tasks.greet.output }}"
  user: "{{ .workflow.input.name }}"
  style: "{{ .workflow.input.style }}"
